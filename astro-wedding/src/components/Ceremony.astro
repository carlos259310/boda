---
---
<section id="ceremonia" class="ceremonia-section animate-on-scroll fade-up">
    <div class="container text-center">
        <div class="evento">
            <div style="display:flex;gap:18px;align-items:flex-start;flex-wrap:wrap;">
                <div class="evento-icon-wrapper" style="flex:0 0 72px;display:flex;align-items:center;justify-content:center;">
                    <svg class="evento-icon" viewBox="0 0 64 64" width="56" height="56" aria-hidden="true">
                        <path d="M32 8 L32 4 M20 10 L16 6 M44 10 L48 6" stroke-linecap="round"/>
                        <path d="M32 16 L32 20 L28 28 L36 28 L32 20 Z" stroke-linejoin="round"/>
                        <rect x="18" y="28" width="28" height="28" rx="2"/>
                        <path d="M24 28 L24 56 M40 28 L40 56"/>
                        <path d="M18 40 L46 40"/>
                        <circle cx="32" cy="20" r="2" fill="currentColor"/>
                        <path d="M28 48 L36 48" stroke-linecap="round" stroke-width="3"/>
                    </svg>
                </div>
                <div style="flex:1;min-width:220px;">
                    <h3 class="evento-title" style="margin:0 0 6px 0;font-size:1.2rem;">Ceremonia y Recepción</h3>
                    <p class="evento-venue" style="margin:0 0 6px 0;font-weight:600;color:var(--muted,#333);">Hostal Joshe — Santa Helena</p>
                    <p class="evento-time" style="margin:0 0 10px 0;color:var(--muted,#666)">Hora: <strong>5:00 pm</strong></p>
                    <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-bottom:10px;">
                        <button id="locationBtn" class="btn" style="padding:8px 12px;cursor:pointer;">Ver ubicación</button>
                        <span style="font-size:0.95rem;color:var(--muted,#666)">Vía a Sta. Helena #a, El Cerrito, Valle del Cauca</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- LOCATION MODAL -->
<div id="locationModal" class="location-modal" aria-hidden="true">
    <div class="location-modal-backdrop" id="locationBackdrop"></div>
    <div class="location-modal-content" role="dialog" aria-modal="true" aria-labelledby="locationTitle">
        <button class="modal-close" id="locationClose" aria-label="Cerrar ubicación">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
        <h3 id="locationTitle">Hostal Joshe - Santa Helena</h3>
        <p class="location-address">Dirección: Vía a Sta. Helena #a, El Cerrito, Valle del Cauca</p>
        <div class="map-wrapper">
            <iframe
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3981.67952332346!2d-76.2479446!3d3.6602861!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8e39f7be1d5fc747%3A0xfc37b0cc86d98b46!2sHostal%20Joshe!5e0!3m2!1ses!2sco!4v1771612439816!5m2!1ses!2sco"
                width="100%"
                height="100%"
                style="border:0;"
                allowfullscreen=""
                loading="lazy"
                referrerpolicy="no-referrer-when-downgrade"
            ></iframe>
        </div>
        <div class="location-actions">
            <button id="copyAddressBtn" class="btn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                Copiar
            </button>
            <button id="openMapsBtn" class="btn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                Maps
            </button>
        </div>
    </div>
</div>

<style>
/* ===== LOCATION MODAL STYLES ===== */
.location-modal {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.4s ease, visibility 0.4s ease;
}

.location-modal[aria-hidden="false"] {
  opacity: 1;
  visibility: visible;
}

.location-modal-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(255, 255, 255, 0.85);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

.location-modal-content {
  position: relative;
  width: min(850px, 92%);
  max-height: 90vh;
  overflow-y: auto;
  background: var(--color-white, #ffffff);
  border-radius: 20px;
  padding: 3.5rem 2.5rem;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
  z-index: 2010;
  border: 1px solid rgba(74, 144, 226, 0.1);
  text-align: center;
  transform: translateY(30px) scale(0.95);
  transition: transform 0.5s cubic-bezier(0.165, 0.84, 0.44, 1);
}

.location-modal[aria-hidden="false"] .location-modal-content {
  transform: translateY(0) scale(1);
}

.modal-close {
  position: absolute;
  right: 1.5rem;
  top: 1.5rem;
  background: var(--color-off-white, #f8fcfd);
  border: none;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: var(--color-text-dark, #2c3e50);
  transition: all 0.3s ease;
  z-index: 2011;
}

.modal-close:hover {
  background: #ffeded;
  color: #e74c3c;
  transform: rotate(90deg);
}

.modal-close svg {
  width: 20px;
  height: 20px;
  stroke: currentColor;
  stroke-width: 2;
  transition: stroke 0.3s ease;
}

.location-modal-content h3 {
  font-family: var(--font-serif, "Playfair Display", serif);
  font-size: 2.4rem;
  color: var(--color-primary, #4a90e2);
  margin-bottom: 0.8rem;
}

.location-address {
  font-family: var(--font-base, "Poppins", sans-serif);
  color: var(--color-text-medium, #596b7d);
  font-size: 1.1rem;
  margin-bottom: 2.5rem;
}

.map-wrapper {
  width: 100%;
  height: 400px;
  border-radius: 15px;
  overflow: hidden;
  margin: 0 0 2.5rem 0;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
  border: 1px solid rgba(74, 144, 226, 0.15);
  position: relative;
}

.map-wrapper iframe {
  width: 100%;
  height: 100%;
  border: 0;
}

.location-actions {
  display: flex;
  gap: 1.2rem;
  justify-content: center;
  flex-wrap: wrap;
}

.location-actions .btn {
  padding: 1rem 2rem;
  font-size: 0.95rem;
  border-radius: 30px;
  flex: 1;
  min-width: 200px;
  max-width: 260px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

.btn.ghost {
  background: transparent;
  border: 1px solid var(--color-primary, #4a90e2);
  color: var(--color-primary, #4a90e2);
  box-shadow: none;
}

.btn.ghost:hover {
  background: rgba(74, 144, 226, 0.05);
  color: var(--color-primary-dark, #357abd);
  border-color: var(--color-primary-dark, #357abd);
}

.cache-status {
  margin-top: 1.5rem;
  font-size: 0.9rem;
  color: var(--color-text-light, #8fa9bc);
  height: 1.5rem;
}

@media (max-width: 768px) {
  .location-modal-content {
    padding: 2.5rem 1.5rem 2rem;
    width: 95%;
  }
  .location-modal-content h3 {
    font-size: 1.8rem;
    margin-top: 1rem;
  }
  .location-address {
    font-size: 1rem;
    margin-bottom: 1.5rem;
  }
  .map-wrapper {
    height: 300px;
    margin-bottom: 1.5rem;
  }
  .modal-close {
    top: 1rem;
    right: 1rem;
    width: 38px;
    height: 38px;
  }
  .location-actions {
    gap: 0.8rem;
  }
}
</style>

<script>
    // ===== LOCATION MODAL & CACHE HELPERS =====
    const locationBtn = document.getElementById('locationBtn');
    const locationModal = document.getElementById('locationModal');
    const locationClose = document.getElementById('locationClose');
    const locationBackdrop = document.getElementById('locationBackdrop');
    const copyAddressBtn = document.getElementById('copyAddressBtn');
    const openMapsBtn = document.getElementById('openMapsBtn');
    const clearCacheBtn = document.getElementById('clearCacheBtn');
    const cacheStatus = document.getElementById('cacheStatus');
    const ADDRESS_TEXT = 'Hostal Joshe, Vía a Sta. Helena #a, El Cerrito, Valle del Cauca';

    function openLocationModal() {
      if (!locationModal) return;
      locationModal.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';
      if (cacheStatus) cacheStatus.textContent = '';
    }

    function closeLocationModal() {
      if (!locationModal) return;
      locationModal.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
    }

    if (locationBtn) locationBtn.addEventListener('click', openLocationModal);
    if (locationClose) locationClose.addEventListener('click', closeLocationModal);
    if (locationBackdrop) locationBackdrop.addEventListener('click', closeLocationModal);

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && locationModal && locationModal.getAttribute('aria-hidden') === 'false') {
        closeLocationModal();
      }
    });

    if (copyAddressBtn) {
      copyAddressBtn.addEventListener('click', async () => {
        try {
          if (navigator.clipboard && navigator.clipboard.writeText) {
            await navigator.clipboard.writeText(ADDRESS_TEXT);
          } else {
            // Fallback
            const ta = document.createElement('textarea');
            ta.value = ADDRESS_TEXT;
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
          }
          if (cacheStatus) cacheStatus.textContent = 'Dirección copiada al portapapeles.';
        } catch (err) {
          if (cacheStatus) cacheStatus.textContent = 'No se pudo copiar. Selecciona y copia manualmente.';
        }
      });
    }

    if (openMapsBtn) {
      openMapsBtn.addEventListener('click', () => {
        // Abrir el enlace específico de Google Maps
        window.open('https://maps.app.goo.gl/UWnKyMH6rmEK9VL56', '_blank');
      });
    }

    async function clearSiteCaches() {
      if (cacheStatus) cacheStatus.textContent = 'Limpiando caché...';
      try {
        if ('caches' in window) {
          const cacheKeys = await caches.keys();
          await Promise.all(cacheKeys.map((k) => caches.delete(k)));
        }

        if (navigator.serviceWorker && navigator.serviceWorker.getRegistrations) {
          const regs = await navigator.serviceWorker.getRegistrations();
          await Promise.all(regs.map((r) => r.unregister()));
        }

        try { localStorage.clear(); } catch (e) {}
        try { sessionStorage.clear(); } catch (e) {}

        if (cacheStatus) cacheStatus.textContent = 'Caché limpiada. Recargando...';
        const url = window.location.pathname + '?v=' + Date.now();
        setTimeout(() => { window.location.href = url; }, 900);
      } catch (err) {
        if (cacheStatus) cacheStatus.textContent = 'Error limpiando caché: ' + (err && err.message ? err.message : err);
      }
    }

    if (clearCacheBtn) clearCacheBtn.addEventListener('click', clearSiteCaches);
</script>
